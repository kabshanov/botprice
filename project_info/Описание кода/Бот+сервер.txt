# üì° –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–µ—Ä–≤–µ—Ä–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏ –¥–ª—è Telegram-–±–æ—Ç–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Google –î–∏—Å–∫, –∞ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º.

---

## üì¶ –û–±—â–µ–µ –û–ø–∏—Å–∞–Ω–∏–µ –ü—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π Telegram-–±–æ—Ç–∞, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤. –ë–æ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, —Å—Ç—Ä–∞–Ω–∞-–ø–æ—Å—Ç–∞–≤—â–∏–∫, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏), —Ä–∞–∑–ª–∏—á–∞–µ—Ç –ø—Ä–æ—Å—Ç—ã–µ –∏ —Å–ª–æ–∂–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã, –∞ –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö SQLite –¥–ª—è –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

## üìÑ –û–ø–∏—Å–∞–Ω–∏–µ –§–∞–π–ª–æ–≤ –ü—Ä–æ–µ–∫—Ç–∞

1. `bot.py`
   - –ì–ª–∞–≤–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Telegram-–±–æ—Ç–∞, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

2. `shared_data.py`
   - –°–æ–¥–µ—Ä–∂–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
     - USER_DATA ‚Äì –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
     - PRODUCT_LIBRARY ‚Äì –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤.
     - COMPLEX_BRANDS ‚Äì —Å–ø–∏—Å–æ–∫ —Å–ª–æ–∂–Ω—ã—Ö –±—Ä–µ–Ω–¥–æ–≤ (Apple Watch, iPad –∏ –¥—Ä.).
     - COUNTRY_EMOJI_MAP, TEXT_TO_FLAG ‚Äì –º–∞–ø–ø–∏–Ω–≥–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω.
     - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤.

3. `utils.py`
   - –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:
     - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤.
     - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ü–µ–Ω—ã, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤.
     - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.
     - Fuzzy-–ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤.

4. `db_utils.py`
   - –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö SQLite:
     - `init_db()` ‚Äì –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã.
     - `add_product()` ‚Äì –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞.
     - `get_all_products()` ‚Äì –≤—ã–±–æ—Ä–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤.
     - `clear_user_data()` ‚Äì –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

5. `sorting_rules.py`
   - –õ–æ–≥–∏–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤.

---

## üóÑ –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **SQLite** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- **–°–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**, –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞.
- **–ë—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Ç–æ–≤–∞—Ä–æ–≤**.
- **–ì–∏–±–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ –±—É–¥—É—â–µ–º**.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã `user_products`:

```sql
CREATE TABLE IF NOT EXISTS user_products (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    product_name TEXT NOT NULL,
    brand TEXT,
    model_group TEXT,
    price INTEGER,
    supplier TEXT,
    comment TEXT,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

---

## ‚öôÔ∏è –°–µ—Ä–≤–∏—Å—ã –∏ —Ç–∞–π–º–µ—Ä—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### üìå 4.1. –°–µ—Ä–≤–∏—Å –¥–ª—è Telegram-–±–æ—Ç–∞

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É Telegram-–±–æ—Ç–∞:

- **–§–∞–π–ª:** `/etc/systemd/system/bot.service`
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
  ```ini
  [Unit]
  Description=My Telegram Bot
  After=network.target

  [Service]
  User=root
  WorkingDirectory=/root/botprice
  ExecStart=/root/botprice/venv/bin/python3 /root/botprice/bot.py
  Restart=always

  [Install]
  WantedBy=multi-user.target
  ```

### üìå 4.2. –°–µ—Ä–≤–∏—Å –∏ —Ç–∞–π–º–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `my_database.db` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è **–Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ** –Ω–∞ Google –î–∏—Å–∫ –¥–≤–∞–∂–¥—ã –≤ –¥–µ–Ω—å: –≤ 01:00 –∏ 13:00.

#### üîπ –°–µ—Ä–≤–∏—Å –¥–ª—è –±—ç–∫–∞–ø–∞

- **–§–∞–π–ª:** `/etc/systemd/system/backup.service`
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ**:
  ```ini
  [Unit]
  Description=Backup my_database.db

  [Service]
  Type=oneshot
  ExecStart=/root/botprice/venv/bin/python3 /root/botprice/backup.py
  ```

#### üîπ –¢–∞–π–º–µ—Ä—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±—ç–∫–∞–ø–∞

1. **–§–∞–π–ª:** `/etc/systemd/system/backup-01.timer`
   ```ini
   [Unit]
   Description=Backup my_database.db at 01:00

   [Timer]
   OnCalendar=*-*-* 01:00:00
   Persistent=true
   Unit=backup.service

   [Install]
   WantedBy=timers.target
   ```

2. **–§–∞–π–ª:** `/etc/systemd/system/backup-13.timer`
   ```ini
   [Unit]
   Description=Backup my_database.db at 13:00

   [Timer]
   OnCalendar=*-*-* 13:00:00
   Persistent=true
   Unit=backup.service

   [Install]
   WantedBy=timers.target
   ```

#### üöÄ –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–æ–≤

```bash
sudo systemctl daemon-reload
sudo systemctl enable backup-01.timer
sudo systemctl enable backup-13.timer
sudo systemctl start backup-01.timer
sudo systemctl start backup-13.timer
```

#### üïí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Ç–∞–π–º–µ—Ä–æ–≤

```bash
systemctl list-timers --all
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
- `backup-01.timer` ‚Üí –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 01:00
- `backup-13.timer` ‚Üí –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 13:00

#### üîé –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±—ç–∫–∞–ø–∞

```bash
journalctl -u backup.service
```

---

## üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞

- **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ systemd (–ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–ª–∏ —Ç–∞–π–º–µ—Ä–æ–≤):**
  ```bash
  sudo systemctl daemon-reload
  ```

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∞–π–º–µ—Ä–æ–≤:**
  ```bash
  systemctl list-timers --all
  ```

- **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–æ—Ç–∞:**
  ```bash
  journalctl -u bot.service
  ```

- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (Ubuntu/Debian):**
  ```bash
  sudo apt update && sudo apt upgrade
  ```

- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤:**
  ```bash
  top
  ```
  –∏–ª–∏, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
  ```bash
  htop
  ```

---

## üìå –ò—Ç–æ–≥

- **–ë–æ—Ç** —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ **SQLite** –≤–º–µ—Å—Ç–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–¥–≤–∞–∂–¥—ã –≤ –¥–µ–Ω—å** –Ω–∞ Google –î–∏—Å–∫.
- **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã systemd** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ, –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

üìÜ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç 24.02.25

–î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ API-–∫–ª—é—á–∞ —Å Google Drive.

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ä–µ–¥—É (—Ç–µ—Å—Ç –∏–ª–∏ –±–æ–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä) –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω—É–∂–Ω—ã–π API-–∫–ª—é—á.

–û–±–Ω–æ–≤–ª–µ–Ω bot.service, —Ç–µ–ø–µ—Ä—å –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BOT_ENV=production.

üõ†Ô∏è –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ API-–∫–ª—é—á–∞ —Å Google Drive

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è API-–∫–ª—é—á–∞ –∏ –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å –¥–∏—Å–∫–∞ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ –¥–≤–∞ —Ñ–∞–π–ª–∞:

api_key_dev.txt ‚Äî –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã.

api_key_prod.txt ‚Äî –¥–ª—è –±–æ–µ–≤–æ–π —Å—Ä–µ–¥—ã.

File ID:

api_key_dev.txt ‚Üí 17wmkEx_aomeLuSoUXzhy96Rt5VRi26Pv

api_key_prod.txt ‚Üí 1ZXRLIXgZgNEFRrW8JKuGJAPWv4Vz2Pg8üìÜ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

–î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ API-–∫–ª—é—á–∞ —Å Google Drive.

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ä–µ–¥—É (—Ç–µ—Å—Ç –∏–ª–∏ –±–æ–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä) –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω—É–∂–Ω—ã–π API-–∫–ª—é—á.

–û–±–Ω–æ–≤–ª–µ–Ω bot.service, —Ç–µ–ø–µ—Ä—å –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BOT_ENV=production.

üõ†Ô∏è –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ API-–∫–ª—é—á–∞ —Å Google Drive

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è API-–∫–ª—é—á–∞ –∏ –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å –¥–∏—Å–∫–∞ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ –¥–≤–∞ —Ñ–∞–π–ª–∞:

api_key_dev.txt ‚Äî –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã.

api_key_prod.txt ‚Äî –¥–ª—è –±–æ–µ–≤–æ–π —Å—Ä–µ–¥—ã.

File ID:

api_key_dev.txt ‚Üí 17wmkEx_aomeLuSoUXzhy96Rt5VRi26Pv

api_key_prod.txt ‚Üí 1ZXRLIXgZgNEFRrW8JKuGJAPWv4Vz2Pg8
